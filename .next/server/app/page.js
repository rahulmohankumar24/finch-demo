(()=>{var e={};e.id=931,e.ids=[931],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7310:e=>{"use strict";e.exports=require("url")},1833:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>c,routeModule:()=>u,tree:()=>o});var a=s(7096),r=s(6132),n=s(7284),l=s.n(n),i=s(2564),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);s.d(t,d);let o=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,3982)),"/Users/rahulmohankumar/Downloads/finch/app/page.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,5345)),"/Users/rahulmohankumar/Downloads/finch/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9291,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/rahulmohankumar/Downloads/finch/app/page.tsx"],m="/page",x={require:s,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},2467:(e,t,s)=>{Promise.resolve().then(s.bind(s,8257))},8257:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>Home});var a,r=s(784),n=s(9885);function ClientSelector({onClientSelect:e,onCreateClient:t}){let[s,a]=(0,n.useState)([]),[l,i]=(0,n.useState)(!0),[d,o]=(0,n.useState)(null);(0,n.useEffect)(()=>{loadClients()},[]);let loadClients=async()=>{try{i(!0);let e=await fetch("/api/clients"),t=await e.json();if(!t.success)throw Error(t.error);a(t.clients)}catch(e){o(e instanceof Error?e.message:"Failed to load clients")}finally{i(!1)}};return l?r.jsx("div",{className:"max-w-4xl mx-auto p-6",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),r.jsx("p",{className:"mt-4 text-gray-600",children:"Loading clients..."})]})}):d?r.jsx("div",{className:"max-w-4xl mx-auto p-6",children:(0,r.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:[r.jsx("strong",{children:"Error:"})," ",d,r.jsx("button",{onClick:loadClients,className:"ml-4 bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600",children:"Retry"})]})}):(0,r.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:[(0,r.jsxs)("div",{className:"text-center mb-8",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Finch Legal Task Management"}),r.jsx("p",{className:"text-gray-600",children:"Select a client to view their matters"})]}),r.jsx("div",{className:"mb-6",children:(0,r.jsxs)("button",{onClick:t,className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Create New Client"]})}),0===s.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[r.jsx("svg",{className:"w-16 h-16 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No clients found"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"Get started by creating your first client"}),r.jsx("button",{onClick:t,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Create First Client"})]}):r.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:s.map(t=>r.jsx("div",{onClick:()=>e(t),className:"border border-gray-200 rounded-lg p-6 hover:border-blue-500 hover:shadow-lg transition-all cursor-pointer group",children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex-1",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-blue-600 transition-colors",children:t.name}),t.email&&r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.email}),t.phone&&r.jsx("p",{className:"text-sm text-gray-600",children:t.phone}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:["Created: ",new Date(t.created_date).toLocaleDateString()]})]}),r.jsx("svg",{className:"w-5 h-5 text-gray-400 group-hover:text-blue-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})},t.client_id))})]})}function TaskManager({matterId:e,tasks:t,dependencies:s={},onTaskExecute:l,onRefresh:i}){let[d,o]=(0,n.useState)(!1),[c,m]=(0,n.useState)(!1),[x,u]=(0,n.useState)(""),[h,p]=(0,n.useState)(""),[g,b]=(0,n.useState)([]),[j,y]=(0,n.useState)(""),[v,f]=(0,n.useState)("custom"),k=Object.entries(t),generateTaskId=e=>{let t=e.toLowerCase().replace(/[^a-z0-9\s]/g,"").trim().replace(/\s+/g,"_"),s=Math.random().toString(36).substring(2,8);return`${t}_${s}`},addDependency=()=>{b([...g,{dependencyType:a.TASK_COMPLETION,targetTaskId:"",timeDelayWeeks:void 0}])},updateDependency=(e,t,s)=>{let a=[...g];a[e]={...a[e],[t]:s},b(a)},removeDependency=e=>{b(g.filter((t,s)=>s!==e))},createTask=async()=>{if(!h){alert("Please fill in task name");return}let t=generateTaskId(h);try{let s=await fetch("/api/tasks/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({matterId:e,taskId:t,name:h,dependencies:g.filter(e=>e.targetTaskId)})}),a=await s.json();a.success?(alert(a.message),o(!1),p(""),b([]),y(""),f("custom"),i()):alert(a.error)}catch(e){console.error("Failed to create task:",e),alert("Failed to create task")}},insertTaskAfter=async()=>{if(!h||!j){alert("Please fill in task name and select where to insert");return}let t=generateTaskId(h);try{let s=await fetch("/api/tasks/insert-after",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({matterId:e,newTaskId:t,newTaskName:h,insertAfterTaskId:j})}),a=await s.json();a.success?(alert(a.message),a.updatedDependencies.count>0&&alert(`Updated ${a.updatedDependencies.count} tasks to depend on the new task`),o(!1),p(""),b([]),y(""),f("custom"),i()):alert(a.error)}catch(e){console.error("Failed to insert task:",e),alert("Failed to insert task")}},getTaskDependencies=e=>s[e]||[],openEditTask=e=>{let t=getTaskDependencies(e),s=t.map(e=>({dependencyType:e.type,targetTaskId:e.targetTask,timeDelayWeeks:e.timeDelayWeeks}));u(e),b(s),m(!0)},saveTaskDependencies=async()=>{if(x)try{let t=await fetch("/api/tasks/edit-dependencies",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({matterId:e,taskId:x,dependencies:g.filter(e=>e.targetTaskId)})}),s=await t.json();s.success?(alert(s.message),m(!1),u(""),b([]),i()):alert(s.error)}catch(e){console.error("Failed to update task dependencies:",e),alert("Failed to update task dependencies")}};return(0,r.jsxs)("div",{className:"space-y-6",children:[r.jsx("div",{className:"space-y-4",children:k.map(([e,t])=>{let s=getTaskDependencies(e);return r.jsx("div",{className:`p-4 border rounded-lg ${t.completed?"border-green-300 bg-green-50":t.canExecute?"border-blue-300 bg-blue-50":"border-gray-300 bg-gray-50"}`,children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx("span",{className:`text-lg ${t.completed?"text-green-600":"text-gray-600"}`,children:t.completed?"✓":"○"}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"font-medium text-lg",children:t.name}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:["ID: ",e]})]})]}),s.length>0&&(0,r.jsxs)("div",{className:"ml-8 mb-3",children:[r.jsx("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"Dependencies:"}),r.jsx("ul",{className:"text-sm space-y-1",children:s.map((e,t)=>(0,r.jsxs)("li",{className:"flex items-center gap-2",children:[r.jsx("span",{className:`w-2 h-2 rounded-full ${e.isMet?"bg-green-500":"bg-red-400"}`}),r.jsx("span",{className:e.isMet?"text-green-600 line-through":"text-gray-600",children:e.description}),e.isMet&&r.jsx("span",{className:"text-green-600 text-xs",children:"✓"})]},t))})]}),(0,r.jsxs)("div",{className:"ml-8 text-sm",children:[t.completed&&t.completionDate&&(0,r.jsxs)("span",{className:"text-green-600",children:["Completed: ",new Date(t.completionDate).toLocaleDateString()]}),!t.completed&&(0,r.jsxs)("span",{className:t.dependenciesMet?"text-blue-600":"text-red-600",children:["Dependencies: ",t.dependenciesMet?"✓ Ready":"✗ Waiting"]})]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>openEditTask(e),className:"px-3 py-1 bg-gray-600 text-white text-sm rounded hover:bg-gray-700 transition-colors",children:"Edit Dependencies"}),t.canExecute&&r.jsx("button",{onClick:()=>l(e),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",children:"Execute"})]})]})},e)})}),r.jsx("div",{className:"flex gap-3",children:r.jsx("button",{onClick:()=>o(!0),className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors",children:"+ Add Custom Task"})}),d&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[r.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Add New Task"}),r.jsx("div",{className:"space-y-4 mb-6",children:(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"Task Name"}),r.jsx("input",{type:"text",value:h,onChange:e=>p(e.target.value),placeholder:"e.g., Review Medical Records",className:"w-full p-2 border border-gray-300 rounded"}),r.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Task ID will be automatically generated based on the name"})]})}),(0,r.jsxs)("div",{className:"mb-6",children:[r.jsx("h4",{className:"font-medium mb-3",children:"How do you want to add this task?"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("label",{className:"flex items-start gap-3 p-3 border rounded hover:bg-gray-50 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"insertType",value:"custom",checked:"custom"===v,onChange:()=>{f("custom"),y("")},className:"mt-1"}),(0,r.jsxs)("div",{children:[r.jsx("div",{className:"font-medium",children:"Custom Dependencies"}),(0,r.jsxs)("div",{className:"text-sm text-gray-600 mt-1",children:[r.jsx("strong",{children:"Manual Setup:"})," You choose exactly which tasks this depends on.",r.jsx("br",{}),"• Perfect for tasks that need specific requirements",r.jsx("br",{}),"• Can depend on multiple tasks",r.jsx("br",{}),'• Can set time-based delays (e.g., "2 weeks after X")',r.jsx("br",{}),"• ",r.jsx("em",{children:'Example: "Final Review" depends on both "Draft Complete" AND "Client Approval"'})]})]})]}),(0,r.jsxs)("label",{className:"flex items-start gap-3 p-3 border rounded hover:bg-gray-50 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"insertType",value:"insert",checked:"insert"===v,onChange:()=>{f("insert"),b([])},className:"mt-1"}),(0,r.jsxs)("div",{children:[r.jsx("div",{className:"font-medium",children:"Insert Into Workflow"}),(0,r.jsxs)("div",{className:"text-sm text-gray-600 mt-1",children:[r.jsx("strong",{children:"Automatic Chain Update:"})," Insert your task between two existing tasks.",r.jsx("br",{}),"• System automatically updates dependency chains",r.jsx("br",{}),"• Perfect for adding steps in the middle of a process",r.jsx("br",{}),"• ",r.jsx("em",{children:"Example: Current flow is A → C, insert B after A → becomes A → B → C"}),r.jsx("br",{}),"• ",r.jsx("span",{className:"text-blue-600",children:"Existing tasks that depended on A will now depend on B"})]})]})]})]}),"insert"===v?(0,r.jsxs)("div",{className:"mt-3",children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"Insert After:"}),(0,r.jsxs)("select",{value:j,onChange:e=>y(e.target.value),className:"w-full p-2 border border-gray-300 rounded",children:[r.jsx("option",{value:"",children:"Select a task..."}),k.map(([e,t])=>r.jsx("option",{value:e,children:t.name},e))]}),r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"This will make your new task depend on the selected task, and update other tasks to depend on your new task instead."})]}):(0,r.jsxs)("div",{className:"mt-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[r.jsx("h4",{className:"font-medium",children:"Dependencies"}),r.jsx("button",{onClick:addDependency,className:"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700",children:"+ Add Dependency"})]}),g.map((e,t)=>(0,r.jsxs)("div",{className:"flex gap-3 items-center mb-3 p-3 border rounded",children:[(0,r.jsxs)("select",{value:e.dependencyType,onChange:e=>updateDependency(t,"dependencyType",e.target.value),className:"p-2 border border-gray-300 rounded",children:[r.jsx("option",{value:a.TASK_COMPLETION,children:"Task Completion"}),r.jsx("option",{value:a.TIME_BASED,children:"Time Based"})]}),(0,r.jsxs)("select",{value:e.targetTaskId,onChange:e=>updateDependency(t,"targetTaskId",e.target.value),className:"flex-1 p-2 border border-gray-300 rounded",children:[r.jsx("option",{value:"",children:"Select task..."}),k.map(([e,t])=>r.jsx("option",{value:e,children:t.name},e))]}),e.dependencyType===a.TIME_BASED&&(0,r.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,r.jsxs)("select",{value:e.timeDelayWeeks||"",onChange:e=>updateDependency(t,"timeDelayWeeks",parseInt(e.target.value)),className:"p-2 border border-gray-300 rounded",children:[r.jsx("option",{value:"",children:"Select time delay..."}),r.jsx("option",{value:"1",children:"1 week"}),r.jsx("option",{value:"2",children:"2 weeks"}),r.jsx("option",{value:"3",children:"3 weeks"}),r.jsx("option",{value:"4",children:"4 weeks (1 month)"}),r.jsx("option",{value:"6",children:"6 weeks"}),r.jsx("option",{value:"8",children:"8 weeks (2 months)"}),r.jsx("option",{value:"12",children:"12 weeks (3 months)"}),r.jsx("option",{value:"16",children:"16 weeks (4 months)"}),r.jsx("option",{value:"24",children:"24 weeks (6 months)"}),r.jsx("option",{value:"52",children:"52 weeks (1 year)"})]}),r.jsx("span",{className:"text-sm text-gray-500",children:"after completion"})]}),r.jsx("button",{onClick:()=>removeDependency(t),className:"px-2 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700",children:"Remove"})]},t))]})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-3",children:[r.jsx("button",{onClick:()=>{o(!1),p(""),f("custom"),y(""),b([])},className:"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Cancel"}),r.jsx("button",{onClick:"insert"===v?insertTaskAfter:createTask,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"insert"===v?"Insert Task":"Create Task"})]})]})}),c&&x&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)("h3",{className:"text-xl font-semibold mb-4",children:['Edit Dependencies for "',t[x]?.name,'"']}),r.jsx("div",{className:"mb-4 p-3 bg-blue-50 rounded border border-blue-200",children:(0,r.jsxs)("div",{className:"text-sm text-blue-800",children:[r.jsx("strong",{children:"\uD83D\uDCA1 Tip:"})," You can now make existing tasks depend on newly created tasks!",r.jsx("br",{}),"• Add dependencies on any task in this matter",r.jsx("br",{}),"• Remove dependencies that are no longer needed",r.jsx("br",{}),"• Set time-based delays for compliance requirements"]})}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[r.jsx("h4",{className:"font-medium",children:"Dependencies"}),r.jsx("button",{onClick:addDependency,className:"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700",children:"+ Add Dependency"})]}),0===g.length?r.jsx("div",{className:"text-gray-500 text-sm p-3 border rounded bg-gray-50",children:"No dependencies. This task can be executed immediately."}):g.map((e,t)=>(0,r.jsxs)("div",{className:"flex gap-3 items-center mb-3 p-3 border rounded",children:[(0,r.jsxs)("select",{value:e.dependencyType,onChange:e=>updateDependency(t,"dependencyType",e.target.value),className:"p-2 border border-gray-300 rounded",children:[r.jsx("option",{value:a.TASK_COMPLETION,children:"Task Completion"}),r.jsx("option",{value:a.TIME_BASED,children:"Time Based"})]}),(0,r.jsxs)("select",{value:e.targetTaskId,onChange:e=>updateDependency(t,"targetTaskId",e.target.value),className:"flex-1 p-2 border border-gray-300 rounded",children:[r.jsx("option",{value:"",children:"Select task..."}),k.filter(([e])=>e!==x).map(([e,t])=>r.jsx("option",{value:e,children:t.name},e))]}),e.dependencyType===a.TIME_BASED&&(0,r.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,r.jsxs)("select",{value:e.timeDelayWeeks||"",onChange:e=>updateDependency(t,"timeDelayWeeks",parseInt(e.target.value)),className:"p-2 border border-gray-300 rounded",children:[r.jsx("option",{value:"",children:"Select time delay..."}),r.jsx("option",{value:"1",children:"1 week"}),r.jsx("option",{value:"2",children:"2 weeks"}),r.jsx("option",{value:"3",children:"3 weeks"}),r.jsx("option",{value:"4",children:"4 weeks (1 month)"}),r.jsx("option",{value:"6",children:"6 weeks"}),r.jsx("option",{value:"8",children:"8 weeks (2 months)"}),r.jsx("option",{value:"12",children:"12 weeks (3 months)"}),r.jsx("option",{value:"16",children:"16 weeks (4 months)"}),r.jsx("option",{value:"24",children:"24 weeks (6 months)"}),r.jsx("option",{value:"52",children:"52 weeks (1 year)"})]}),r.jsx("span",{className:"text-sm text-gray-500",children:"after completion"})]}),r.jsx("button",{onClick:()=>removeDependency(t),className:"px-2 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700",children:"Remove"})]},t))]}),(0,r.jsxs)("div",{className:"flex justify-end gap-3",children:[r.jsx("button",{onClick:()=>{m(!1),u(""),b([])},className:"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Cancel"}),r.jsx("button",{onClick:saveTaskDependencies,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Save Dependencies"})]})]})})]})}function StandaloneTaskManager({matterId:e}){let[t,s]=(0,n.useState)(null),[a,l]=(0,n.useState)(!0),[i,d]=(0,n.useState)(null);(0,n.useEffect)(()=>{fetchMatterStatus()},[e]);let fetchMatterStatus=async()=>{try{l(!0);let t=await fetch(`/api/matters/${e}/dependencies`),a=await t.json();a.success?(s(a),d(null)):d(a.error)}catch(e){d(e instanceof Error?e.message:"Failed to fetch matter status")}finally{l(!1)}},executeTask=async t=>{try{let s=await fetch("/api/tasks/execute",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({matterId:e,taskId:t})}),a=await s.json();a.success?(alert(a.result),a.executed&&await fetchMatterStatus()):alert(a.error)}catch(e){console.error("Failed to execute task:",e),alert("Failed to execute task")}};return a?(0,r.jsxs)("div",{className:"flex items-center justify-center p-8",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),r.jsx("span",{className:"ml-3",children:"Loading tasks..."})]}):i?(0,r.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:[r.jsx("strong",{children:"Error:"})," ",i,r.jsx("button",{onClick:fetchMatterStatus,className:"ml-4 bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600",children:"Retry"})]}):t?(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:t.matter.matterId}),r.jsx("p",{className:"text-gray-600",children:t.matter.clientName})]}),r.jsx(TaskManager,{matterId:e,tasks:t.tasks,dependencies:t.dependencies,onTaskExecute:executeTask,onRefresh:fetchMatterStatus})]}):r.jsx("div",{className:"text-center text-gray-500 p-8",children:"Matter not found"})}function ClientMattersView({client:e,onBack:t}){let[s,a]=(0,n.useState)([]),[l,i]=(0,n.useState)(null),[d,o]=(0,n.useState)(!0),[c,m]=(0,n.useState)(null),[x,u]=(0,n.useState)(!1),[h,p]=(0,n.useState)(""),[g,b]=(0,n.useState)(!1);(0,n.useEffect)(()=>{loadMatters()},[e.client_id]);let loadMatters=async()=>{try{o(!0);let t=await fetch(`/api/clients/${e.client_id}/matters`),s=await t.json();if(!s.success)throw Error(s.error);let r=s.matters.map(t=>({matterId:t.matter_id,clientId:t.client_id,clientName:e.name,createdDate:t.created_date,totalTasks:0,completedTasks:0}));a(r)}catch(e){m(e instanceof Error?e.message:"Failed to load matters")}finally{o(!1)}},createMatter=async()=>{if(h.trim())try{b(!0);let t=h.toLowerCase().replace(/[^a-z0-9]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,""),s=await fetch(`/api/clients/${e.client_id}/matters/create`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({matterId:t,clientName:e.name})}),r=await s.json();if(!r.success)throw Error(r.error);let n={matterId:r.matter.matterId,clientId:r.matter.clientId,clientName:r.matter.clientName,createdDate:r.matter.createdDate,totalTasks:r.matter.totalTasks,completedTasks:r.matter.completedTasks};a(e=>[n,...e]),p(""),u(!1)}catch(e){m(e instanceof Error?e.message:"Failed to create matter")}finally{b(!1)}};return l?(0,r.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:[(0,r.jsxs)("button",{onClick:()=>i(null),className:"flex items-center text-blue-600 hover:text-blue-800 mb-4",children:[r.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to ",e.name]}),r.jsx(StandaloneTaskManager,{matterId:l})]}):d?r.jsx("div",{className:"max-w-4xl mx-auto p-6",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),r.jsx("p",{className:"mt-4 text-gray-600",children:"Loading matters..."})]})}):(0,r.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsxs)("button",{onClick:t,className:"flex items-center text-blue-600 hover:text-blue-800 mb-4",children:[r.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Clients"]}),r.jsx("div",{className:"flex items-center justify-between",children:(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:e.name}),r.jsx("p",{className:"text-gray-600",children:"Matters and Cases"}),e.email&&r.jsx("p",{className:"text-sm text-gray-500 mt-1",children:e.email})]})})]}),c&&(0,r.jsxs)("div",{className:"mb-6 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:[c,r.jsx("button",{onClick:()=>m(null),className:"ml-2 text-red-500 hover:text-red-700",children:"\xd7"})]}),r.jsx("div",{className:"mb-6",children:x?(0,r.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[r.jsx("h3",{className:"text-lg font-medium mb-3",children:"Create New Matter"}),(0,r.jsxs)("div",{className:"flex gap-3",children:[r.jsx("input",{type:"text",value:h,onChange:e=>p(e.target.value),placeholder:"Enter matter name",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",onKeyPress:e=>"Enter"===e.key&&createMatter()}),r.jsx("button",{onClick:createMatter,disabled:g||!h.trim(),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:g?"Creating...":"Create"}),r.jsx("button",{onClick:()=>{u(!1),p("")},className:"bg-gray-300 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-400",children:"Cancel"})]})]}):(0,r.jsxs)("button",{onClick:()=>u(!0),className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Create New Matter"]})}),0===s.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[r.jsx("svg",{className:"w-16 h-16 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No matters found"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"Create your first matter for this client"}),r.jsx("button",{onClick:()=>u(!0),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Create First Matter"})]}):r.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:s.map(e=>r.jsx("div",{onClick:()=>i(e.matterId),className:"border border-gray-200 rounded-lg p-6 hover:border-blue-500 hover:shadow-lg transition-all cursor-pointer group",children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex-1",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-blue-600 transition-colors",children:e.matterId.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}),(0,r.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Created: ",new Date(e.createdDate).toLocaleDateString()]}),(0,r.jsxs)("div",{className:"mt-3 flex items-center gap-4 text-xs text-gray-500",children:[(0,r.jsxs)("span",{children:["Tasks: ",e.totalTasks]}),(0,r.jsxs)("span",{children:["Completed: ",e.completedTasks]})]})]}),r.jsx("svg",{className:"w-5 h-5 text-gray-400 group-hover:text-blue-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})},e.matterId))})]})}function CreateClientModal({isOpen:e,onClose:t,onClientCreated:s}){let[a,l]=(0,n.useState)({name:"",email:"",phone:"",address:""}),[i,d]=(0,n.useState)(!1),[o,c]=(0,n.useState)(null),handleSubmit=async e=>{if(e.preventDefault(),!a.name.trim()){c("Client name is required");return}try{d(!0),c(null);let e=await fetch("/api/clients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:a.name.trim(),email:a.email.trim()||null,phone:a.phone.trim()||null,address:a.address.trim()||null})}),r=await e.json();if(!r.success)throw Error(r.error);s(r.client),l({name:"",email:"",phone:"",address:""}),t()}catch(e){c(e instanceof Error?e.message:"Failed to create client")}finally{d(!1)}},handleInputChange=e=>t=>{l(s=>({...s,[e]:t.target.value})),o&&c(null)};return e?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Create New Client"}),r.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),o&&r.jsx("div",{className:"mb-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:o}),(0,r.jsxs)("form",{onSubmit:handleSubmit,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Name *"}),r.jsx("input",{type:"text",id:"name",value:a.name,onChange:handleInputChange("name"),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter client name",required:!0})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),r.jsx("input",{type:"email",id:"email",value:a.email,onChange:handleInputChange("email"),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"client@example.com"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),r.jsx("input",{type:"tel",id:"phone",value:a.phone,onChange:handleInputChange("phone"),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"(555) 123-4567"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),r.jsx("textarea",{id:"address",value:a.address,onChange:handleInputChange("address"),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Client address"})]}),(0,r.jsxs)("div",{className:"flex gap-3 pt-4",children:[r.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors",disabled:i,children:"Cancel"}),r.jsx("button",{type:"submit",disabled:i||!a.name.trim(),className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:i?"Creating...":"Create Client"})]})]})]})}):null}function Home(){let[e,t]=(0,n.useState)(null),[s,a]=(0,n.useState)(!1);return e?r.jsx(ClientMattersView,{client:e,onBack:()=>{t(null)}}):(0,r.jsxs)(r.Fragment,{children:[r.jsx(ClientSelector,{onClientSelect:e=>{t(e)},onCreateClient:()=>{a(!0)}}),r.jsx(CreateClientModal,{isOpen:s,onClose:()=>a(!1),onClientCreated:e=>{t(e)}})]})}!function(e){e.TASK_COMPLETION="task_completion",e.TIME_BASED="time_based"}(a||(a={}))},3982:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>l,__esModule:()=>n,default:()=>d});var a=s(5153);let r=(0,a.createProxy)(String.raw`/Users/rahulmohankumar/Downloads/finch/app/page.tsx`),{__esModule:n,$$typeof:l}=r,i=r.default,d=i},784:(e,t,s)=>{"use strict";e.exports=s(316).vendored["react-ssr"].ReactJsxRuntime}};var t=require("../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[472,116],()=>__webpack_exec__(1833));module.exports=s})();