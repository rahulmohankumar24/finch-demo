(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1264:function(e,t,s){Promise.resolve().then(s.bind(s,3945))},3945:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return Home}});var a,r,n=s(7437),l=s(2265);function ClientSelector(e){let{onClientSelect:t,onCreateClient:s}=e,[a,r]=(0,l.useState)([]),[i,d]=(0,l.useState)(!0),[o,c]=(0,l.useState)(null);(0,l.useEffect)(()=>{loadClients()},[]);let loadClients=async()=>{try{d(!0);let e=await fetch("/api/clients"),t=await e.json();if(!t.success)throw Error(t.error);r(t.clients)}catch(e){c(e instanceof Error?e.message:"Failed to load clients")}finally{d(!1)}};return i?(0,n.jsx)("div",{className:"max-w-4xl mx-auto p-6",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,n.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading clients..."})]})}):o?(0,n.jsx)("div",{className:"max-w-4xl mx-auto p-6",children:(0,n.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:[(0,n.jsx)("strong",{children:"Error:"})," ",o,(0,n.jsx)("button",{onClick:loadClients,className:"ml-4 bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600",children:"Retry"})]})}):(0,n.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:[(0,n.jsxs)("div",{className:"text-center mb-8",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Finch Legal Task Management"}),(0,n.jsx)("p",{className:"text-gray-600",children:"Select a client to view their matters"})]}),(0,n.jsx)("div",{className:"mb-6",children:(0,n.jsxs)("button",{onClick:s,className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[(0,n.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Create New Client"]})}),0===a.length?(0,n.jsxs)("div",{className:"text-center py-12",children:[(0,n.jsx)("svg",{className:"w-16 h-16 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),(0,n.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No clients found"}),(0,n.jsx)("p",{className:"text-gray-600 mb-4",children:"Get started by creating your first client"}),(0,n.jsx)("button",{onClick:s,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Create First Client"})]}):(0,n.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:a.map(e=>(0,n.jsx)("div",{onClick:()=>t(e),className:"border border-gray-200 rounded-lg p-6 hover:border-blue-500 hover:shadow-lg transition-all cursor-pointer group",children:(0,n.jsxs)("div",{className:"flex items-start justify-between",children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-blue-600 transition-colors",children:e.name}),e.email&&(0,n.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.email}),e.phone&&(0,n.jsx)("p",{className:"text-sm text-gray-600",children:e.phone}),(0,n.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:["Created: ",new Date(e.created_date).toLocaleDateString()]})]}),(0,n.jsx)("svg",{className:"w-5 h-5 text-gray-400 group-hover:text-blue-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})},e.client_id))})]})}function TaskManager(e){var t;let{matterId:s,tasks:a,dependencies:i={},onTaskExecute:d,onRefresh:o}=e,[c,m]=(0,l.useState)(!1),[x,u]=(0,l.useState)(!1),[h,p]=(0,l.useState)(""),[g,b]=(0,l.useState)(""),[j,y]=(0,l.useState)([]),[v,f]=(0,l.useState)(""),[N,k]=(0,l.useState)("custom"),w=Object.entries(a),generateTaskId=e=>{let t=e.toLowerCase().replace(/[^a-z0-9\s]/g,"").trim().replace(/\s+/g,"_"),s=Math.random().toString(36).substring(2,8);return"".concat(t,"_").concat(s)},addDependency=()=>{y([...j,{dependencyType:r.TASK_COMPLETION,targetTaskId:"",timeDelayWeeks:void 0}])},updateDependency=(e,t,s)=>{let a=[...j];a[e]={...a[e],[t]:s},y(a)},removeDependency=e=>{y(j.filter((t,s)=>s!==e))},createTask=async()=>{if(!g){alert("Please fill in task name");return}let e=generateTaskId(g);try{let t=await fetch("/api/tasks/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({matterId:s,taskId:e,name:g,dependencies:j.filter(e=>e.targetTaskId)})}),a=await t.json();a.success?(alert(a.message),m(!1),b(""),y([]),f(""),k("custom"),o()):alert(a.error)}catch(e){console.error("Failed to create task:",e),alert("Failed to create task")}},insertTaskAfter=async()=>{if(!g||!v){alert("Please fill in task name and select where to insert");return}let e=generateTaskId(g);try{let t=await fetch("/api/tasks/insert-after",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({matterId:s,newTaskId:e,newTaskName:g,insertAfterTaskId:v})}),a=await t.json();a.success?(alert(a.message),a.updatedDependencies.count>0&&alert("Updated ".concat(a.updatedDependencies.count," tasks to depend on the new task")),m(!1),b(""),y([]),f(""),k("custom"),o()):alert(a.error)}catch(e){console.error("Failed to insert task:",e),alert("Failed to insert task")}},getTaskDependencies=e=>i[e]||[],openEditTask=e=>{let t=getTaskDependencies(e),s=t.map(e=>({dependencyType:e.type,targetTaskId:e.targetTask,timeDelayWeeks:e.timeDelayWeeks}));p(e),y(s),u(!0)},saveTaskDependencies=async()=>{if(h)try{let e=await fetch("/api/tasks/edit-dependencies",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({matterId:s,taskId:h,dependencies:j.filter(e=>e.targetTaskId)})}),t=await e.json();t.success?(alert(t.message),u(!1),p(""),y([]),o()):alert(t.error)}catch(e){console.error("Failed to update task dependencies:",e),alert("Failed to update task dependencies")}};return(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsx)("div",{className:"space-y-4",children:w.map(e=>{let[t,s]=e,a=getTaskDependencies(t);return(0,n.jsx)("div",{className:"p-4 border rounded-lg ".concat(s.completed?"border-green-300 bg-green-50":s.canExecute?"border-blue-300 bg-blue-50":"border-gray-300 bg-gray-50"),children:(0,n.jsxs)("div",{className:"flex justify-between items-start",children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,n.jsx)("span",{className:"text-lg ".concat(s.completed?"text-green-600":"text-gray-600"),children:s.completed?"✓":"○"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"font-medium text-lg",children:s.name}),(0,n.jsxs)("div",{className:"text-sm text-gray-500",children:["ID: ",t]})]})]}),a.length>0&&(0,n.jsxs)("div",{className:"ml-8 mb-3",children:[(0,n.jsx)("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"Dependencies:"}),(0,n.jsx)("ul",{className:"text-sm space-y-1",children:a.map((e,t)=>(0,n.jsxs)("li",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{className:"w-2 h-2 rounded-full ".concat(e.isMet?"bg-green-500":"bg-red-400")}),(0,n.jsx)("span",{className:e.isMet?"text-green-600 line-through":"text-gray-600",children:e.description}),e.isMet&&(0,n.jsx)("span",{className:"text-green-600 text-xs",children:"✓"})]},t))})]}),(0,n.jsxs)("div",{className:"ml-8 text-sm",children:[s.completed&&s.completionDate&&(0,n.jsxs)("span",{className:"text-green-600",children:["Completed: ",new Date(s.completionDate).toLocaleDateString()]}),!s.completed&&(0,n.jsxs)("span",{className:s.dependenciesMet?"text-blue-600":"text-red-600",children:["Dependencies: ",s.dependenciesMet?"✓ Ready":"✗ Waiting"]})]})]}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("button",{onClick:()=>openEditTask(t),className:"px-3 py-1 bg-gray-600 text-white text-sm rounded hover:bg-gray-700 transition-colors",children:"Edit Dependencies"}),s.canExecute&&(0,n.jsx)("button",{onClick:()=>d(t),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",children:"Execute"})]})]})},t)})}),(0,n.jsx)("div",{className:"flex gap-3",children:(0,n.jsx)("button",{onClick:()=>m(!0),className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors",children:"+ Add Custom Task"})}),c&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,n.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,n.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"Add New Task"}),(0,n.jsx)("div",{className:"space-y-4 mb-6",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Task Name"}),(0,n.jsx)("input",{type:"text",value:g,onChange:e=>b(e.target.value),placeholder:"e.g., Review Medical Records",className:"w-full p-2 border border-gray-300 rounded"}),(0,n.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Task ID will be automatically generated based on the name"})]})}),(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("h4",{className:"font-medium mb-3",children:"How do you want to add this task?"}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("label",{className:"flex items-start gap-3 p-3 border rounded hover:bg-gray-50 cursor-pointer",children:[(0,n.jsx)("input",{type:"radio",name:"insertType",value:"custom",checked:"custom"===N,onChange:()=>{k("custom"),f("")},className:"mt-1"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"font-medium",children:"Custom Dependencies"}),(0,n.jsxs)("div",{className:"text-sm text-gray-600 mt-1",children:[(0,n.jsx)("strong",{children:"Manual Setup:"})," You choose exactly which tasks this depends on.",(0,n.jsx)("br",{}),"• Perfect for tasks that need specific requirements",(0,n.jsx)("br",{}),"• Can depend on multiple tasks",(0,n.jsx)("br",{}),'• Can set time-based delays (e.g., "2 weeks after X")',(0,n.jsx)("br",{}),"• ",(0,n.jsx)("em",{children:'Example: "Final Review" depends on both "Draft Complete" AND "Client Approval"'})]})]})]}),(0,n.jsxs)("label",{className:"flex items-start gap-3 p-3 border rounded hover:bg-gray-50 cursor-pointer",children:[(0,n.jsx)("input",{type:"radio",name:"insertType",value:"insert",checked:"insert"===N,onChange:()=>{k("insert"),y([])},className:"mt-1"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"font-medium",children:"Insert Into Workflow"}),(0,n.jsxs)("div",{className:"text-sm text-gray-600 mt-1",children:[(0,n.jsx)("strong",{children:"Automatic Chain Update:"})," Insert your task between two existing tasks.",(0,n.jsx)("br",{}),"• System automatically updates dependency chains",(0,n.jsx)("br",{}),"• Perfect for adding steps in the middle of a process",(0,n.jsx)("br",{}),"• ",(0,n.jsx)("em",{children:"Example: Current flow is A → C, insert B after A → becomes A → B → C"}),(0,n.jsx)("br",{}),"• ",(0,n.jsx)("span",{className:"text-blue-600",children:"Existing tasks that depended on A will now depend on B"})]})]})]})]}),"insert"===N?(0,n.jsxs)("div",{className:"mt-3",children:[(0,n.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Insert After:"}),(0,n.jsxs)("select",{value:v,onChange:e=>f(e.target.value),className:"w-full p-2 border border-gray-300 rounded",children:[(0,n.jsx)("option",{value:"",children:"Select a task..."}),w.map(e=>{let[t,s]=e;return(0,n.jsx)("option",{value:t,children:s.name},t)})]}),(0,n.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"This will make your new task depend on the selected task, and update other tasks to depend on your new task instead."})]}):(0,n.jsxs)("div",{className:"mt-6",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,n.jsx)("h4",{className:"font-medium",children:"Dependencies"}),(0,n.jsx)("button",{onClick:addDependency,className:"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700",children:"+ Add Dependency"})]}),j.map((e,t)=>(0,n.jsxs)("div",{className:"flex gap-3 items-center mb-3 p-3 border rounded",children:[(0,n.jsxs)("select",{value:e.dependencyType,onChange:e=>updateDependency(t,"dependencyType",e.target.value),className:"p-2 border border-gray-300 rounded",children:[(0,n.jsx)("option",{value:r.TASK_COMPLETION,children:"Task Completion"}),(0,n.jsx)("option",{value:r.TIME_BASED,children:"Time Based"})]}),(0,n.jsxs)("select",{value:e.targetTaskId,onChange:e=>updateDependency(t,"targetTaskId",e.target.value),className:"flex-1 p-2 border border-gray-300 rounded",children:[(0,n.jsx)("option",{value:"",children:"Select task..."}),w.map(e=>{let[t,s]=e;return(0,n.jsx)("option",{value:t,children:s.name},t)})]}),e.dependencyType===r.TIME_BASED&&(0,n.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,n.jsxs)("select",{value:e.timeDelayWeeks||"",onChange:e=>updateDependency(t,"timeDelayWeeks",parseInt(e.target.value)),className:"p-2 border border-gray-300 rounded",children:[(0,n.jsx)("option",{value:"",children:"Select time delay..."}),(0,n.jsx)("option",{value:"1",children:"1 week"}),(0,n.jsx)("option",{value:"2",children:"2 weeks"}),(0,n.jsx)("option",{value:"3",children:"3 weeks"}),(0,n.jsx)("option",{value:"4",children:"4 weeks (1 month)"}),(0,n.jsx)("option",{value:"6",children:"6 weeks"}),(0,n.jsx)("option",{value:"8",children:"8 weeks (2 months)"}),(0,n.jsx)("option",{value:"12",children:"12 weeks (3 months)"}),(0,n.jsx)("option",{value:"16",children:"16 weeks (4 months)"}),(0,n.jsx)("option",{value:"24",children:"24 weeks (6 months)"}),(0,n.jsx)("option",{value:"52",children:"52 weeks (1 year)"})]}),(0,n.jsx)("span",{className:"text-sm text-gray-500",children:"after completion"})]}),(0,n.jsx)("button",{onClick:()=>removeDependency(t),className:"px-2 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700",children:"Remove"})]},t))]})]}),(0,n.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,n.jsx)("button",{onClick:()=>{m(!1),b(""),k("custom"),f(""),y([])},className:"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Cancel"}),(0,n.jsx)("button",{onClick:"insert"===N?insertTaskAfter:createTask,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"insert"===N?"Insert Task":"Create Task"})]})]})}),x&&h&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,n.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,n.jsxs)("h3",{className:"text-xl font-semibold mb-4",children:['Edit Dependencies for "',null===(t=a[h])||void 0===t?void 0:t.name,'"']}),(0,n.jsx)("div",{className:"mb-4 p-3 bg-blue-50 rounded border border-blue-200",children:(0,n.jsxs)("div",{className:"text-sm text-blue-800",children:[(0,n.jsx)("strong",{children:"\uD83D\uDCA1 Tip:"})," You can now make existing tasks depend on newly created tasks!",(0,n.jsx)("br",{}),"• Add dependencies on any task in this matter",(0,n.jsx)("br",{}),"• Remove dependencies that are no longer needed",(0,n.jsx)("br",{}),"• Set time-based delays for compliance requirements"]})}),(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,n.jsx)("h4",{className:"font-medium",children:"Dependencies"}),(0,n.jsx)("button",{onClick:addDependency,className:"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700",children:"+ Add Dependency"})]}),0===j.length?(0,n.jsx)("div",{className:"text-gray-500 text-sm p-3 border rounded bg-gray-50",children:"No dependencies. This task can be executed immediately."}):j.map((e,t)=>(0,n.jsxs)("div",{className:"flex gap-3 items-center mb-3 p-3 border rounded",children:[(0,n.jsxs)("select",{value:e.dependencyType,onChange:e=>updateDependency(t,"dependencyType",e.target.value),className:"p-2 border border-gray-300 rounded",children:[(0,n.jsx)("option",{value:r.TASK_COMPLETION,children:"Task Completion"}),(0,n.jsx)("option",{value:r.TIME_BASED,children:"Time Based"})]}),(0,n.jsxs)("select",{value:e.targetTaskId,onChange:e=>updateDependency(t,"targetTaskId",e.target.value),className:"flex-1 p-2 border border-gray-300 rounded",children:[(0,n.jsx)("option",{value:"",children:"Select task..."}),w.filter(e=>{let[t]=e;return t!==h}).map(e=>{let[t,s]=e;return(0,n.jsx)("option",{value:t,children:s.name},t)})]}),e.dependencyType===r.TIME_BASED&&(0,n.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,n.jsxs)("select",{value:e.timeDelayWeeks||"",onChange:e=>updateDependency(t,"timeDelayWeeks",parseInt(e.target.value)),className:"p-2 border border-gray-300 rounded",children:[(0,n.jsx)("option",{value:"",children:"Select time delay..."}),(0,n.jsx)("option",{value:"1",children:"1 week"}),(0,n.jsx)("option",{value:"2",children:"2 weeks"}),(0,n.jsx)("option",{value:"3",children:"3 weeks"}),(0,n.jsx)("option",{value:"4",children:"4 weeks (1 month)"}),(0,n.jsx)("option",{value:"6",children:"6 weeks"}),(0,n.jsx)("option",{value:"8",children:"8 weeks (2 months)"}),(0,n.jsx)("option",{value:"12",children:"12 weeks (3 months)"}),(0,n.jsx)("option",{value:"16",children:"16 weeks (4 months)"}),(0,n.jsx)("option",{value:"24",children:"24 weeks (6 months)"}),(0,n.jsx)("option",{value:"52",children:"52 weeks (1 year)"})]}),(0,n.jsx)("span",{className:"text-sm text-gray-500",children:"after completion"})]}),(0,n.jsx)("button",{onClick:()=>removeDependency(t),className:"px-2 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700",children:"Remove"})]},t))]}),(0,n.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,n.jsx)("button",{onClick:()=>{u(!1),p(""),y([])},className:"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Cancel"}),(0,n.jsx)("button",{onClick:saveTaskDependencies,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Save Dependencies"})]})]})})]})}function StandaloneTaskManager(e){let{matterId:t}=e,[s,a]=(0,l.useState)(null),[r,i]=(0,l.useState)(!0),[d,o]=(0,l.useState)(null);(0,l.useEffect)(()=>{fetchMatterStatus()},[t]);let fetchMatterStatus=async()=>{try{i(!0);let e=await fetch("/api/matters/".concat(t,"/dependencies")),s=await e.json();s.success?(a(s),o(null)):o(s.error)}catch(e){o(e instanceof Error?e.message:"Failed to fetch matter status")}finally{i(!1)}},executeTask=async e=>{try{let s=await fetch("/api/tasks/execute",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({matterId:t,taskId:e})}),a=await s.json();a.success?(alert(a.result),a.executed&&await fetchMatterStatus()):alert(a.error)}catch(e){console.error("Failed to execute task:",e),alert("Failed to execute task")}};return r?(0,n.jsxs)("div",{className:"flex items-center justify-center p-8",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,n.jsx)("span",{className:"ml-3",children:"Loading tasks..."})]}):d?(0,n.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:[(0,n.jsx)("strong",{children:"Error:"})," ",d,(0,n.jsx)("button",{onClick:fetchMatterStatus,className:"ml-4 bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600",children:"Retry"})]}):s?(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:s.matter.matterId}),(0,n.jsx)("p",{className:"text-gray-600",children:s.matter.clientName})]}),(0,n.jsx)(TaskManager,{matterId:t,tasks:s.tasks,dependencies:s.dependencies,onTaskExecute:executeTask,onRefresh:fetchMatterStatus})]}):(0,n.jsx)("div",{className:"text-center text-gray-500 p-8",children:"Matter not found"})}function ClientMattersView(e){let{client:t,onBack:s}=e,[a,r]=(0,l.useState)([]),[i,d]=(0,l.useState)(null),[o,c]=(0,l.useState)(!0),[m,x]=(0,l.useState)(null),[u,h]=(0,l.useState)(!1),[p,g]=(0,l.useState)(""),[b,j]=(0,l.useState)(!1);(0,l.useEffect)(()=>{loadMatters()},[t.client_id]);let loadMatters=async()=>{try{c(!0);let e=await fetch("/api/clients/".concat(t.client_id,"/matters")),s=await e.json();if(!s.success)throw Error(s.error);let a=s.matters.map(e=>({matterId:e.matter_id,clientId:e.client_id,clientName:t.name,createdDate:e.created_date,totalTasks:0,completedTasks:0}));r(a)}catch(e){x(e instanceof Error?e.message:"Failed to load matters")}finally{c(!1)}},createMatter=async()=>{if(p.trim())try{j(!0);let e=p.toLowerCase().replace(/[^a-z0-9]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,""),s=await fetch("/api/clients/".concat(t.client_id,"/matters/create"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({matterId:e,clientName:t.name})}),a=await s.json();if(!a.success)throw Error(a.error);let n={matterId:a.matter.matterId,clientId:a.matter.clientId,clientName:a.matter.clientName,createdDate:a.matter.createdDate,totalTasks:a.matter.totalTasks,completedTasks:a.matter.completedTasks};r(e=>[n,...e]),g(""),h(!1)}catch(e){x(e instanceof Error?e.message:"Failed to create matter")}finally{j(!1)}};return i?(0,n.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:[(0,n.jsxs)("button",{onClick:()=>d(null),className:"flex items-center text-blue-600 hover:text-blue-800 mb-4",children:[(0,n.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to ",t.name]}),(0,n.jsx)(StandaloneTaskManager,{matterId:i})]}):o?(0,n.jsx)("div",{className:"max-w-4xl mx-auto p-6",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,n.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading matters..."})]})}):(0,n.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:[(0,n.jsxs)("div",{className:"mb-8",children:[(0,n.jsxs)("button",{onClick:s,className:"flex items-center text-blue-600 hover:text-blue-800 mb-4",children:[(0,n.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Clients"]}),(0,n.jsx)("div",{className:"flex items-center justify-between",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:t.name}),(0,n.jsx)("p",{className:"text-gray-600",children:"Matters and Cases"}),t.email&&(0,n.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:t.email})]})})]}),m&&(0,n.jsxs)("div",{className:"mb-6 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:[m,(0,n.jsx)("button",{onClick:()=>x(null),className:"ml-2 text-red-500 hover:text-red-700",children:"\xd7"})]}),(0,n.jsx)("div",{className:"mb-6",children:u?(0,n.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,n.jsx)("h3",{className:"text-lg font-medium mb-3",children:"Create New Matter"}),(0,n.jsxs)("div",{className:"flex gap-3",children:[(0,n.jsx)("input",{type:"text",value:p,onChange:e=>g(e.target.value),placeholder:"Enter matter name",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",onKeyPress:e=>"Enter"===e.key&&createMatter()}),(0,n.jsx)("button",{onClick:createMatter,disabled:b||!p.trim(),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:b?"Creating...":"Create"}),(0,n.jsx)("button",{onClick:()=>{h(!1),g("")},className:"bg-gray-300 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-400",children:"Cancel"})]})]}):(0,n.jsxs)("button",{onClick:()=>h(!0),className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[(0,n.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Create New Matter"]})}),0===a.length?(0,n.jsxs)("div",{className:"text-center py-12",children:[(0,n.jsx)("svg",{className:"w-16 h-16 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,n.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No matters found"}),(0,n.jsx)("p",{className:"text-gray-600 mb-4",children:"Create your first matter for this client"}),(0,n.jsx)("button",{onClick:()=>h(!0),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Create First Matter"})]}):(0,n.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:a.map(e=>(0,n.jsx)("div",{onClick:()=>d(e.matterId),className:"border border-gray-200 rounded-lg p-6 hover:border-blue-500 hover:shadow-lg transition-all cursor-pointer group",children:(0,n.jsxs)("div",{className:"flex items-start justify-between",children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-blue-600 transition-colors",children:e.matterId.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}),(0,n.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Created: ",new Date(e.createdDate).toLocaleDateString()]}),(0,n.jsxs)("div",{className:"mt-3 flex items-center gap-4 text-xs text-gray-500",children:[(0,n.jsxs)("span",{children:["Tasks: ",e.totalTasks]}),(0,n.jsxs)("span",{children:["Completed: ",e.completedTasks]})]})]}),(0,n.jsx)("svg",{className:"w-5 h-5 text-gray-400 group-hover:text-blue-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})},e.matterId))})]})}function CreateClientModal(e){let{isOpen:t,onClose:s,onClientCreated:a}=e,[r,i]=(0,l.useState)({name:"",email:"",phone:"",address:""}),[d,o]=(0,l.useState)(!1),[c,m]=(0,l.useState)(null),handleSubmit=async e=>{if(e.preventDefault(),!r.name.trim()){m("Client name is required");return}try{o(!0),m(null);let e=await fetch("/api/clients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r.name.trim(),email:r.email.trim()||null,phone:r.phone.trim()||null,address:r.address.trim()||null})}),t=await e.json();if(!t.success)throw Error(t.error);a(t.client),i({name:"",email:"",phone:"",address:""}),s()}catch(e){m(e instanceof Error?e.message:"Failed to create client")}finally{o(!1)}},handleInputChange=e=>t=>{i(s=>({...s,[e]:t.target.value})),c&&m(null)};return t?(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,n.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Create New Client"}),(0,n.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,n.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c&&(0,n.jsx)("div",{className:"mb-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:c}),(0,n.jsxs)("form",{onSubmit:handleSubmit,className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Name *"}),(0,n.jsx)("input",{type:"text",id:"name",value:r.name,onChange:handleInputChange("name"),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter client name",required:!0})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),(0,n.jsx)("input",{type:"email",id:"email",value:r.email,onChange:handleInputChange("email"),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"client@example.com"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),(0,n.jsx)("input",{type:"tel",id:"phone",value:r.phone,onChange:handleInputChange("phone"),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"(555) 123-4567"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),(0,n.jsx)("textarea",{id:"address",value:r.address,onChange:handleInputChange("address"),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Client address"})]}),(0,n.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,n.jsx)("button",{type:"button",onClick:s,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors",disabled:d,children:"Cancel"}),(0,n.jsx)("button",{type:"submit",disabled:d||!r.name.trim(),className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:d?"Creating...":"Create Client"})]})]})]})}):null}function Home(){let[e,t]=(0,l.useState)(null),[s,a]=(0,l.useState)(!1);return e?(0,n.jsx)(ClientMattersView,{client:e,onBack:()=>{t(null)}}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ClientSelector,{onClientSelect:e=>{t(e)},onCreateClient:()=>{a(!0)}}),(0,n.jsx)(CreateClientModal,{isOpen:s,onClose:()=>a(!1),onClientCreated:e=>{t(e)}})]})}(a=r||(r={})).TASK_COMPLETION="task_completion",a.TIME_BASED="time_based"},622:function(e,t,s){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a=s(2265),r=Symbol.for("react.element"),n=Symbol.for("react.fragment"),l=Object.prototype.hasOwnProperty,i=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,d={key:!0,ref:!0,__self:!0,__source:!0};function q(e,t,s){var a,n={},o=null,c=null;for(a in void 0!==s&&(o=""+s),void 0!==t.key&&(o=""+t.key),void 0!==t.ref&&(c=t.ref),t)l.call(t,a)&&!d.hasOwnProperty(a)&&(n[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===n[a]&&(n[a]=t[a]);return{$$typeof:r,type:e,key:o,ref:c,props:n,_owner:i.current}}t.Fragment=n,t.jsx=q,t.jsxs=q},7437:function(e,t,s){"use strict";e.exports=s(622)}},function(e){e.O(0,[971,472,744],function(){return e(e.s=1264)}),_N_E=e.O()}]);